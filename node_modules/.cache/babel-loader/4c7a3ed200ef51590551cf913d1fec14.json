{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar extract_files_1 = require(\"extract-files\");\n\nvar form_data_1 = __importDefault(require(\"form-data\"));\n/**\r\n * Duck type if NodeJS stream\r\n * https://github.com/sindresorhus/is-stream/blob/3750505b0727f6df54324784fe369365ef78841e/index.js#L3\r\n */\n\n\nvar isExtractableFileEnhanced = function isExtractableFileEnhanced(value) {\n  return extract_files_1.isExtractableFile(value) || value !== null && typeof value === 'object' && typeof value.pipe === 'function';\n};\n/**\r\n * Returns Multipart Form if body contains files\r\n * (https://github.com/jaydenseric/graphql-multipart-request-spec)\r\n * Otherwise returns JSON\r\n */\n\n\nfunction createRequestBody(query, variables) {\n  var _a = extract_files_1.extractFiles({\n    query: query,\n    variables: variables\n  }, '', isExtractableFileEnhanced),\n      clone = _a.clone,\n      files = _a.files;\n\n  if (files.size === 0) {\n    return JSON.stringify(clone);\n  }\n\n  var Form = typeof FormData === 'undefined' ? form_data_1.default : FormData;\n  var form = new Form();\n  form.append('operations', JSON.stringify(clone));\n  var map = {};\n  var i = 0;\n  files.forEach(function (paths) {\n    map[++i] = paths;\n  });\n  form.append('map', JSON.stringify(map));\n  i = 0;\n  files.forEach(function (paths, file) {\n    form.append(\"\" + ++i, file);\n  });\n  return form;\n}\n\nexports.default = createRequestBody;","map":{"version":3,"sources":["../src/createRequestBody.ts"],"names":[],"mappings":";;;;;;;;;;;;AAAA,IAAA,eAAA,GAAA,OAAA,CAAA,eAAA,CAAA;;AACA,IAAA,WAAA,GAAA,eAAA,CAAA,OAAA,CAAA,WAAA,CAAA,CAAA;AAIA;;;AAGG;;;AACH,IAAM,yBAAyB,GAAG,SAA5B,yBAA4B,CAAC,KAAD,EAAW;AAC3C,SAAA,eAAA,CAAA,iBAAA,CAAkB,KAAlB,KACC,KAAK,KAAK,IAAV,IAAkB,OAAO,KAAP,KAAiB,QAAnC,IAA+C,OAAO,KAAK,CAAC,IAAb,KAAsB,UADtE;AACiF,CAFnF;AAIA;;;;AAIG;;;AACH,SAAwB,iBAAxB,CAA0C,KAA1C,EAAyD,SAAzD,EAA8E;AACtE,MAAA,EAAA,GAAmB,eAAA,CAAA,YAAA,CAAa;AAAE,IAAA,KAAK,EAAA,KAAP;AAAS,IAAA,SAAS,EAAA;AAAlB,GAAb,EAAmC,EAAnC,EAAuC,yBAAvC,CAAnB;AAAA,MAAE,KAAK,GAAA,EAAA,CAAA,KAAP;AAAA,MAAS,KAAK,GAAA,EAAA,CAAA,KAAd;;AAEN,MAAI,KAAK,CAAC,IAAN,KAAe,CAAnB,EAAsB;AACpB,WAAO,IAAI,CAAC,SAAL,CAAe,KAAf,CAAP;AACD;;AAED,MAAM,IAAI,GAAG,OAAO,QAAP,KAAoB,WAApB,GAAkC,WAAA,CAAA,OAAlC,GAAiD,QAA9D;AAEA,MAAM,IAAI,GAAG,IAAI,IAAJ,EAAb;AAEA,EAAA,IAAI,CAAC,MAAL,CAAY,YAAZ,EAA0B,IAAI,CAAC,SAAL,CAAe,KAAf,CAA1B;AAEA,MAAM,GAAG,GAAgC,EAAzC;AACA,MAAI,CAAC,GAAG,CAAR;AACA,EAAA,KAAK,CAAC,OAAN,CAAc,UAAC,KAAD,EAAM;AAClB,IAAA,GAAG,CAAC,EAAE,CAAH,CAAH,GAAW,KAAX;AACD,GAFD;AAGA,EAAA,IAAI,CAAC,MAAL,CAAY,KAAZ,EAAmB,IAAI,CAAC,SAAL,CAAe,GAAf,CAAnB;AAEA,EAAA,CAAC,GAAG,CAAJ;AACA,EAAA,KAAK,CAAC,OAAN,CAAc,UAAC,KAAD,EAAQ,IAAR,EAAY;AACxB,IAAA,IAAI,CAAC,MAAL,CAAY,KAAG,EAAE,CAAjB,EAAsB,IAAtB;AACD,GAFD;AAIA,SAAO,IAAP;AACD;;AA1BD,OAAA,CAAA,OAAA,GAAA,iBAAA","sourceRoot":"","sourcesContent":["\"use strict\";\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar extract_files_1 = require(\"extract-files\");\r\nvar form_data_1 = __importDefault(require(\"form-data\"));\r\n/**\r\n * Duck type if NodeJS stream\r\n * https://github.com/sindresorhus/is-stream/blob/3750505b0727f6df54324784fe369365ef78841e/index.js#L3\r\n */\r\nvar isExtractableFileEnhanced = function (value) {\r\n    return extract_files_1.isExtractableFile(value) ||\r\n        (value !== null && typeof value === 'object' && typeof value.pipe === 'function');\r\n};\r\n/**\r\n * Returns Multipart Form if body contains files\r\n * (https://github.com/jaydenseric/graphql-multipart-request-spec)\r\n * Otherwise returns JSON\r\n */\r\nfunction createRequestBody(query, variables) {\r\n    var _a = extract_files_1.extractFiles({ query: query, variables: variables }, '', isExtractableFileEnhanced), clone = _a.clone, files = _a.files;\r\n    if (files.size === 0) {\r\n        return JSON.stringify(clone);\r\n    }\r\n    var Form = typeof FormData === 'undefined' ? form_data_1.default : FormData;\r\n    var form = new Form();\r\n    form.append('operations', JSON.stringify(clone));\r\n    var map = {};\r\n    var i = 0;\r\n    files.forEach(function (paths) {\r\n        map[++i] = paths;\r\n    });\r\n    form.append('map', JSON.stringify(map));\r\n    i = 0;\r\n    files.forEach(function (paths, file) {\r\n        form.append(\"\" + ++i, file);\r\n    });\r\n    return form;\r\n}\r\nexports.default = createRequestBody;\r\n//# sourceMappingURL=createRequestBody.js.map"]},"metadata":{},"sourceType":"script"}